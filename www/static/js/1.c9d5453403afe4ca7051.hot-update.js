webpackHotUpdate(1,{1289:function(e,t,n){"use strict";function D(e){return e&&e.__esModule?e:{"default":e}}var r=n(1136),i=D(r),s=n(565),o=D(s),u=n(566),a=D(u),f=n(617),l=D(f),c=n(24),h=D(c),p=n(181),d=D(p),v=n(625),m=D(v),g=n(478),y=n(757),b=D(y),w=n(654),E=n(650),S=D(E),x=n(987),T=D(x),N=n(1121),C=D(N),k=n(1246),L=D(k),A=n(1247),O=D(A),M=n(1119),_=D(M);e.exports=function(e){function t(n){(0,o.default)(this,t);var r=(0,a.default)(this,e.call(this,n));return r.state={submitting:!1,options:SysConfig.options},r.state.options.hasOwnProperty("push")||(r.state.options.push="0"),r.state.options.analyze_code=unescape(SysConfig.options.analyze_code),r.state.options.site_url||(r.state.options.site_url=location.protocol+"//"+location.host),r}return(0,l.default)(t,e),t.prototype.componentDidMount=function(){this.listenTo(O.default,this.handleTrigger.bind(this))},t.prototype.handleTrigger=function(t,n){switch(n){case"saveOptionsSuccess":this.setState({submitting:!1}),_.default.success("更新成功");for(var r in this.optionsSavedValue)SysConfig.options[r]=this.optionsSavedValue[r]}},t.prototype.changeInput=function(t,n){var r=n.target.value,i=this.state.options;i[t]=r,this.setState({options:i})},t.prototype.getProps=function(t){var n={value:this.state.options[t]||"",onChange:this.changeInput.bind(this,t)};return["title","description"].indexOf(t)>-1&&(n.validate="required"),n},t.prototype.handleValidSubmit=function(t){this.setState({submitting:!0}),this.optionsSavedValue=t,L.default.save(t)},t.prototype.handleInvalidSubmit=function(){},t.prototype.render=function(){var t=this,n={};this.state.submitting&&(n.disabled=!0);var r=this.state.options.logo_url,s=this.state.options.favicon_url;return r&&!r.includes("data:image")&&(r+=(r.includes("?")?"&":"?")+"m="+Date.now()),s&&!s.includes("data:image")&&(s+=(s.includes("?")?"&":"?")+"m="+Date.now()),h.default.createElement("div",{className:"fk-content-wrap"},h.default.createElement(C.default,this.props),h.default.createElement("div",{className:"manage-container"},h.default.createElement("h3",{style:{marginBottom:"20px"}},"基本设置"),h.default.createElement(w.Form,{className:"clearfix options-general",onValidSubmit:this.handleValidSubmit.bind(this),onInvalidSubmit:this.handleInvalidSubmit.bind(this)},h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"站点名称"),h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"title",ref:"title"},this.getProps("title"),{className:"form-control",errorHelp:{required:"请填写站点名称"}}))),h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"LOGO 地址"),r?h.default.createElement("img",{src:r,width:"140px",height:"140px",alt:"logo",style:{display:"block",marginBottom:"10px"}}):null,h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"logo_url"},this.getProps("logo_url"),{ref:"logo_url",className:"form-control"})),h.default.createElement("p",{className:"help-block"},"尺寸最好为 140x140px。",h.default.createElement("button",{type:"button",className:"btn btn-default",onClick:function(){return d.default.findDOMNode(t.refs.logoInput).click()}},this.state.logo_uploading?"正在":"","上传"),h.default.createElement("input",{type:"file",ref:"logoInput",style:{display:"none"},accept:"image/*",onChange:function(n){var r=n.target.files[0];if(!r)return!1;t.state.options.logo_url="",t.setState({logo_uploading:!0},function(){var e=new FormData;e.append("file",r),e.append("name","logo"),T.default.upload(e).then(function(e){t.state.options.logo_url=e.data,t.state.logo_uploading=!1,t.forceUpdate()})})}}))),h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"站点描述"),h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"description"},this.getProps("description"),{ref:"description",className:"form-control",errorHelp:{required:"请填写站点描述"}}))),h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"网站地址"),h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"site_url"},this.getProps("site_url"),{ref:"site_url",className:"form-control",errorHelp:{required:"请填写网站地址"}}))),h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"Favicon 地址"),s?h.default.createElement("img",{src:s,alt:"logo",style:{display:"block",marginBottom:"10px",maxWidth:"128px",maxHeight:"128px"}}):null,h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"favicon_url"},this.getProps("favicon_url"),{ref:"favicon_url",className:"form-control"})),h.default.createElement("p",{className:"help-block"},"尺寸最好为 128x128px。",h.default.createElement("button",{type:"button",className:"btn btn-default",onClick:function(){return d.default.findDOMNode(t.refs.faviconInput).click()}},this.state.favicon_uploading?"正在":"","上传"),h.default.createElement("input",{type:"file",ref:"faviconInput",style:{display:"none"},accept:"image/x-icon",onChange:function(n){var r=n.target.files[0];if(!r)return!1;t.state.options.favicon_url="",t.setState({favicon_uploading:!0},function(){var e=new FormData;e.append("file",r),e.append("name","favicon"),T.default.upload(e).then(function(e){t.state.options.favicon_url=e.data,t.state.favicon_uploading=!1,t.forceUpdate()})})}}))),h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"关键词"),h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"keywords"},this.getProps("keywords"),{ref:"keywords",className:"form-control",errorHelp:{required:"请填写站点关键词"}})),h.default.createElement("p",{className:"help-block"},'请以半角逗号 "," 分割多个关键字.')),h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"GitHub 地址"),h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"github_url"},this.getProps("github_url"),{ref:"github_url",className:"form-control"}))),h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"Twitter 地址"),h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"twitter_url"},this.getProps("twitter_url"),{ref:"twitter_url",className:"form-control"}))),h.default.createElement("div",{className:"form-group"},h.default.createElement("label",null,"网站备案号"),h.default.createElement(w.ValidatedInput,(0,i.default)({type:"text",name:"miitbeian"},this.getProps("miitbeian"),{ref:"miitbeian",className:"form-control"}))),h.default.createElement("button",(0,i.default)({type:"submit"},n,{className:"btn btn-primary"}),this.state.submitting?"提交中...":"提交"))))},t}(m.default)}})